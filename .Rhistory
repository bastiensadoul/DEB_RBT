fres
str(fres)
summary(fres)
fres$condition=factor(fres$condition)
fres
summary(fres)
ggplot(data=fres, aes(x=study, y=f, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_color_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
?bargraph.CI
bargraph.CI(condition, f, data=fres[fres$study=="gw124end",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw150",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124end",], ylim=c(0,1))
ggplot(data=fres, aes(x=study, y=f, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_color_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
ggplot(data=fres, aes(x=study, y=f, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
predres=readMat("prdDatafuniqueall.mat")$f[,,1]
readMat("prdDatafuniqueall.mat")
readMat("prdDatafuniqueall.mat")$f[,,1]
readMat("prdDatafuniqueall.mat")$prdData
readMat("prdDatafuniqueall.mat")
readMat("prdDatafuniqueall.mat")$prdData[,,1]
predres=readMat("prdDatafuniqueall.mat")$prdData[,,1]
predres=readMat("prdDatafuniqueall.mat")$prdData[,,1]
names(predres)
tank="tW.gw150A"
predres$tank
predres[[tank]]
temp=predres[[tank]]
eval(tank, "=predres[[tank]]")
tank
predres[[tank]]
eval(tank, "=predres[[tank]]")
eval(eval(tank), "=predres[[tank]]")
eval(parse(text=tank), "=predres[[tank]]")
parse(text=tank)
eval(parse(text=tank, "=predres[[tank]]"))
eval(parse(text=tank, ""=predres[[tank]]""))
eval(parse(text=tank, "=predres[[tank]]"))
eval(parse(text=tank), "=predres[[tank]]"))
eval(parse(text=tank), "=predres[[tank]]")
assign("tank ="),predres[[tank]])
assign("tank =",predres[[tank]])
assign(parse(text="tank ="),predres[[tank]])
assign(parse(text="tank"),predres[[tank]])
eval(parse(text=tank), "=predres[[tank]]")
temp=predres[[tank]]
temp
for (tank in names(predres)){
temp=predres[[tank]]
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W
}
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W
}
eval(parse(text=tank), "=temp")
parse(text=tank)
eval(parse(text=paste(tank, "=temp", sep="")))
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W
eval(parse(text=paste(tank, "=temp", sep="")))
}
temp$diff[-1]
tank
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
temp
areaError=(temp$t1+temp$time)/2*(temp$diff+temp$difft1)/2
areaError
sum(areaError)
predres
res_areaError=data.frame(tank=names(predres), areaError=rep(NA, length(names(predres))))
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W*100
eval(parse(text=paste(tank, "=temp", sep="")))
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
areaError=sum((temp$t1+temp$time)/2*(temp$diff+temp$difft1)/2)
res_areaError[tank==tank, areaError]
}
predres=readMat("prdDatafuniqueall.mat")$prdData[,,1]
res_areaError=data.frame(tank=names(predres), areaError=rep(NA, length(names(predres))))
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W*100
eval(parse(text=paste(tank, "=temp", sep="")))
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
areaError=sum((temp$t1+temp$time)/2*(temp$diff+temp$difft1)/2)
res_areaError[tank==tank, areaError]=areaError
}
predres=readMat("prdDatafuniqueall.mat")$prdData[,,1]
res_areaError=data.frame(tank=names(predres), areaError=rep(NA, length(names(predres))))
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W*100
eval(parse(text=paste(tank, "=temp", sep="")))
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
areaError=sum((temp$t1+temp$time)/2*(temp$diff+temp$difft1)/2)
res_areaError[tank==tank, areaError]=areaError
predres=readMat("prdDatafuniqueall.mat")$prdData[,,1]
res_areaError=data.frame(tank=names(predres), areaError=rep(NA, length(names(predres))))
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W*100
eval(parse(text=paste(tank, "=temp", sep="")))
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
areaError=sum((temp$t1+temp$time)/2*(temp$diff+temp$difft1)/2)
res_areaError[tank==tank, "areaError"]=areaError
}
res_areaError
tank==tank
predres=readMat("prdDatafuniqueall.mat")$prdData[,,1]
res_areaError=data.frame(tank=names(predres), areaError=rep(NA, length(names(predres))))
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W*100
eval(parse(text=paste(tank, "=temp", sep="")))
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
areaError=sum((temp$t1+temp$time)/2*(temp$diff+temp$difft1)/2)
res_areaError[res_areaError$tank==tank, "areaError"]=areaError
}
res_areaError$tk=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
res_areaError$condition=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
res_areaError[res_areaError$condition=="", "condition"]="BPA0"
res_areaError$study=substr(res_areaError$tk, 1, 5)
res_areaError[res_areaError$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
ggplot(data=res_areaError, aes(x=study, y=areaError, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
res_areaError$condition <- factor(res_areaError$condition, levels = c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"))
ggplot(data=res_areaError, aes(x=study, y=areaError, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
# For pred res: 1st column = day, 2nd column = predict, 3rd column = real
predres=readMat("prdDatafuniqueall.mat")$prdData[,,1]
res_areaError=data.frame(tank=names(predres), areaError=rep(NA, length(names(predres))))
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W*100
eval(parse(text=paste(tank, "=temp", sep="")))
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
areaError=sum((temp$t1+temp$time)/2*(temp$diff+temp$difft1)/2)
res_areaError[res_areaError$tank==tank, "areaError"]=areaError
}
res_areaError$tk=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
res_areaError$condition=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
res_areaError[res_areaError$condition=="", "condition"]="BPA0"
res_areaError$study=substr(res_areaError$tk, 1, 5)
res_areaError[res_areaError$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
res_areaError
summary(res_areaError)
unique(areaError$condition)
unique(res_areaError$condition)
res_areaError$condition <- factor(res_areaError$condition, levels = c("BPA0", "BPA03", "BPA3", "BPA30", "BPA100", "BPA100end", "BPA300"))
ggplot(data=res_areaError, aes(x=study, y=areaError, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
library("R.matlab")
dir="/Users/Bastien/Documents/DEB_RBT/"
setwd(dir)
################------------------------------------------------ Graph f
fres=readMat("f_prdDatafuniqueall.mat")$f[,,1]
fres=data.frame(tank=names(fres), f=matrix(unlist(fres), nrow=length(fres), byrow=T))
library(reshape2)
fres$tk=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
fres$condition=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
fres[fres$condition=="", "condition"]="BPA0"
fres$study=substr(fres$tk, 1, 5)
fres[fres$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
library(sciplot)
bargraph.CI(condition, f, data=fres[fres$study=="gw150",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124end",], ylim=c(0,1))
mod=lm(f~condition, fres[fres$study=="gw150",])
anova(mod)
summary(mod)
library(ggplot2)
fres$condition <- factor(fres$condition, levels = c("BPA0", "BPA03", "BPA3", "BPA30", "BPA100", "BPA100end", "BPA300"))
ggplot(data=fres, aes(x=study, y=f, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
ggplot(data=res_areaError, aes(x=study, y=areaError, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
ggplot(data=res_areaError, aes(x=study, y=areaError, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("AUC for diff") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
fres=readMat(paste("f_prdData", prd, ".mat", sep="")$f[,,1]
fres=data.frame(tank=names(fres), f=matrix(unlist(fres), nrow=length(fres), byrow=T))
prd="funique_control"
################------------------------------------------------ Graph f
fres=readMat(paste("f_prdData", prd, ".mat", sep="")$f[,,1]
)
fres=readMat(paste("f_prdData", prd, ".mat", sep=""))$f[,,1]
fres=readMat(paste("f_prdData_", prd, ".mat", sep=""))$f[,,1]
predres=readMat(paste("prdData_", prd, ".mat", sep=""))$prdData[,,1]
res_areaError=data.frame(tank=names(predres), areaError=rep(NA, length(names(predres))))
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W*100
eval(parse(text=paste(tank, "=temp", sep="")))
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
areaError=sum((temp$t1+temp$time)/2*(temp$diff+temp$difft1)/2)
res_areaError[res_areaError$tank==tank, "areaError"]=areaError
}
res_areaError$tk=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
res_areaError$condition=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
res_areaError[res_areaError$condition=="", "condition"]="BPA0"
res_areaError$study=substr(res_areaError$tk, 1, 5)
res_areaError[res_areaError$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
res_areaError$condition <- factor(res_areaError$condition, levels = c("BPA0", "BPA03", "BPA3", "BPA30", "BPA100", "BPA100end", "BPA300"))
ggplot(data=res_areaError, aes(x=study, y=areaError, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("AUC for diff") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
temp
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W*100
eval(parse(text=paste(tank, "=temp", sep="")))
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
areaError=sum((temp$t1+temp$time)/2*(temp$diff-temp$difft1))
res_areaError[res_areaError$tank==tank, "areaError"]=areaError
}
res_areaError$tk=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
res_areaError$condition=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
res_areaError[res_areaError$condition=="", "condition"]="BPA0"
res_areaError$study=substr(res_areaError$tk, 1, 5)
res_areaError[res_areaError$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
res_areaError$condition <- factor(res_areaError$condition, levels = c("BPA0", "BPA03", "BPA3", "BPA30", "BPA100", "BPA100end", "BPA300"))
ggplot(data=res_areaError, aes(x=study, y=areaError, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("AUC for diff") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
res_areaError=res_areaError[res_areaError$study == "gw124end",]
library("R.matlab")
dir="/Users/Bastien/Documents/DEB_RBT/"
setwd(dir)
################ Specify types of data
prd="funique_control"
################------------------------------------------------ Graph f
fres=readMat(f_prdData_funique_all)$f[,,1]
#fres=readMat(paste("f_prdData_", prd, ".mat", sep=""))$f[,,1]
fres=data.frame(tank=names(fres), f=matrix(unlist(fres), nrow=length(fres), byrow=T))
library(reshape2)
fres$tk=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
fres$condition=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
fres[fres$condition=="", "condition"]="BPA0"
fres$study=substr(fres$tk, 1, 5)
fres[fres$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
library(sciplot)
bargraph.CI(condition, f, data=fres[fres$study=="gw150",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124end",], ylim=c(0,1))
mod=lm(f~condition, fres[fres$study=="gw150",])
anova(mod)
summary(mod)
library(ggplot2)
fres$condition <- factor(fres$condition, levels = c("BPA0", "BPA03", "BPA3", "BPA30", "BPA100", "BPA100end", "BPA300"))
ggplot(data=fres, aes(x=study, y=f, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
################------------------------------------------------ Graph diff
# For pred res: 1st column = day, 2nd column = predict, 3rd column = real
predres=readMat(paste("prdData_", prd, ".mat", sep=""))$prdData[,,1]
res_areaError=data.frame(tank=names(predres), areaError=rep(NA, length(names(predres))))
for (tank in names(predres)){
temp=data.frame(predres[[tank]])
names(temp)=c("time", "EW", "W")
temp$diff=(temp$EW-temp$W)/temp$W*100
eval(parse(text=paste(tank, "=temp", sep="")))
temp$difft1=c(temp$diff[-1], temp$diff[length(temp$diff)])
temp$t1=c(temp$time[-1], temp$time[length(temp$time)])
areaError=sum((temp$t1+temp$time)/2*(temp$diff-temp$difft1))
res_areaError[res_areaError$tank==tank, "areaError"]=areaError
}
res_areaError$tk=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
res_areaError$condition=colsplit(res_areaError$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
res_areaError[res_areaError$condition=="", "condition"]="BPA0"
res_areaError$study=substr(res_areaError$tk, 1, 5)
res_areaError[res_areaError$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
res_areaError$condition <- factor(res_areaError$condition, levels = c("BPA0", "BPA03", "BPA3", "BPA30", "BPA100", "BPA100end", "BPA300"))
res_areaError=res_areaError[!res_areaError$study == "gw124end",]
res_areaError
res_areaError$condition <- factor(res_areaError$condition)
summary(res_areaError)
ggplot(data=res_areaError, aes(x=study, y=areaError, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("AUC for diff") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
library("R.matlab")
dir="/Users/Bastien/Documents/DEB_RBT/"
setwd(dir)
################ Specify types of data
prd="funique_control"
################------------------------------------------------ Graph f
fres=readMat(f_prdData_funique_all)$f[,,1]
#fres=readMat(paste("f_prdData_", prd, ".mat", sep=""))$f[,,1]
fres=data.frame(tank=names(fres), f=matrix(unlist(fres), nrow=length(fres), byrow=T))
library(reshape2)
fres$tk=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
fres$condition=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
fres[fres$condition=="", "condition"]="BPA0"
fres$study=substr(fres$tk, 1, 5)
fres[fres$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
library(sciplot)
bargraph.CI(condition, f, data=fres[fres$study=="gw150",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124end",], ylim=c(0,1))
mod=lm(f~condition, fres[fres$study=="gw150",])
anova(mod)
summary(mod)
library(ggplot2)
fres$condition <- factor(fres$condition, levels = c("BPA0", "BPA03", "BPA3", "BPA30", "BPA100", "BPA100end", "BPA300"))
ggplot(data=fres, aes(x=study, y=f, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
library("R.matlab")
dir="/Users/Bastien/Documents/DEB_RBT/"
setwd(dir)
################ Specify types of data
prd="funique_control"
################------------------------------------------------ Graph f
fres=readMat(f_prdData_funique_all)$f[,,1]
#fres=readMat(paste("f_prdData_", prd, ".mat", sep=""))$f[,,1]
fres=data.frame(tank=names(fres), f=matrix(unlist(fres), nrow=length(fres), byrow=T))
library(reshape2)
fres$tk=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
fres$condition=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
fres[fres$condition=="", "condition"]="BPA0"
fres$study=substr(fres$tk, 1, 5)
fres[fres$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
library("R.matlab")
dir="/Users/Bastien/Documents/DEB_RBT/"
setwd(dir)
################ Specify types of data
prd="funique_control"
################------------------------------------------------ Graph f
fres=readMat(f_prdData_funique_all)$f[,,1]
fres=readMat("f_prdData_funique_all")$f[,,1]
#fres=readMat(paste("f_prdData_", prd, ".mat", sep=""))$f[,,1]
fres=data.frame(tank=names(fres), f=matrix(unlist(fres), nrow=length(fres), byrow=T))
library(reshape2)
fres$tk=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
fres$condition=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
fres[fres$condition=="", "condition"]="BPA0"
fres$study=substr(fres$tk, 1, 5)
fres[fres$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
library(sciplot)
bargraph.CI(condition, f, data=fres[fres$study=="gw150",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124end",], ylim=c(0,1))
fres=readMat("f_prdData_funique_all")$f[,,1]
fres=readMat("f_prdData_funique_all.mat")$f[,,1]
#fres=readMat(paste("f_prdData_", prd, ".mat", sep=""))$f[,,1]
fres=data.frame(tank=names(fres), f=matrix(unlist(fres), nrow=length(fres), byrow=T))
library(reshape2)
fres$tk=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
fres$condition=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
fres[fres$condition=="", "condition"]="BPA0"
fres$study=substr(fres$tk, 1, 5)
fres[fres$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
library(sciplot)
bargraph.CI(condition, f, data=fres[fres$study=="gw150",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124end",], ylim=c(0,1))
mod=lm(f~condition, fres[fres$study=="gw150",])
anova(mod)
summary(mod)
library(ggplot2)
fres$condition <- factor(fres$condition, levels = c("BPA0", "BPA03", "BPA3", "BPA30", "BPA100", "BPA100end", "BPA300"))
ggplot(data=fres, aes(x=study, y=f, fill=condition)) +
geom_bar(position = "dodge", stat = "summary", fun.y = "mean") +                        # Thinner lines
xlab("studies") + ylab("f") + # Set axis labels+
# scale_fill_manual(labels=c("control", "BPA0.3", "BPA3", "BPA30", "BPA100", "BPA300"),
#                   values=c("#00FF00", "#669900", "#CC3200", "#CB0000", "#650000", "#000000"))+
scale_fill_manual("legend", values = c("BPA0" = "#00FF00", "BPA03" = "#669900", "BPA3" = "#CC3200", "BPA30"="#CB0000", "BPA100"="#650000", "BPA100end"="#650000", "BPA300"="#000000"))
ggtitle("f for different studies") +     # Set title
theme_bw()
temp=fres[which(fres$study %in% c("gw124", "gw150") &&
fres$condition %in% c("BPA0)),]
bargraph.CI(condition, f, data=temp, ylim=c(0,1))
))
)))))
]
]
,
?
library("R.matlab")
dir="/Users/Bastien/Documents/DEB_RBT/"
setwd(dir)
################ Specify types of data
prd="funique_control"
################------------------------------------------------ Graph f
fres=readMat("f_prdData_funique_all.mat")$f[,,1]
#fres=readMat(paste("f_prdData_", prd, ".mat", sep=""))$f[,,1]
fres=data.frame(tank=names(fres), f=matrix(unlist(fres), nrow=length(fres), byrow=T))
library(reshape2)
fres$tk=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 2]
fres$condition=colsplit(fres$tank,pattern="\\.", c("tw", "tk", "condition"))[, 3]
fres[fres$condition=="", "condition"]="BPA0"
fres$study=substr(fres$tk, 1, 5)
fres[fres$tank %in% c("tW.gw124fin", "tW.gw124.BPA100end"), "study"]="gw124end"
library(sciplot)
bargraph.CI(condition, f, data=fres[fres$study=="gw150",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124",], ylim=c(0,1))
bargraph.CI(condition, f, data=fres[fres$study=="gw124end",], ylim=c(0,1))
temp=fres[which(fres$study %in% c("gw124", "gw150") &
fres$condition %in% c("BPA0")),]
bargraph.CI(condition, f, data=temp, ylim=c(0,1))
bargraph.CI(study, f, data=temp, ylim=c(0,1))
?bargraph.CI
bargraph.CI(study, f, data=temp, ylim=c(0,1), yleg=c("study 1", "study 2"))
bargraph.CI(study, f, data=temp, ylim=c(0,1), ylab=c("study 1", "study 2"))
bargraph.CI(study, f, data=temp, ylim=c(0,1), xlab=c("study 1", "study 2"))
bargraph.CI(study, f, data=temp, ylim=c(0,1), xleg=c("study 1", "study 2"))
?bargraph.CI
bargraph.CI(study, f, data=temp, ylim=c(0,1), leg.lab=c("study 1", "study 2"))
